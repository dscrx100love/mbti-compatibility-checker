// MBTI基本データ
const mbtiTypes = {
    'INTJ': {
        name: '建築家',
        emoji: '🧠',
        traits: '論理的かつ戦略的。先を読む力に優れ、独立心が強い完璧主義者',
        communication: '率直で理論的。根拠を重視し、効率的な解決策を提案する',
        needs: '知性と独立性。価値観が合い自分のビジョンを理解し支えてくれる人'
    },
    'INTP': {
        name: '論理学者',
        emoji: '🔬',
        traits: '理論的で創造的。複雑な問題を分析し、新しいアイデアを生み出す',
        communication: '論理的で客観的。議論を楽しみ、知的な会話を求める',
        needs: '知的刺激と自由。論理的思考を理解し、独立性を尊重してくれる人'
    },
    'ENTJ': {
        name: '指揮官',
        emoji: '👔',
        traits: '決断力と統率力に優れ、目標達成に邁進するリーダー',
        communication: '断定的で論理的。明確なビジョンを示し、効率性を求める',
        needs: '自立したパートナーシップ。対等に議論でき、目標を共有できる人'
    },
    'ENTP': {
        name: '討論者',
        emoji: '💡',
        traits: '機知に富み、知的挑戦を楽しむ。革新的なアイデアを生み出す',
        communication: '議論好きで創造的。新しい視点を提供し、知的な刺激を求める',
        needs: '知的な刺激と変化。議論を楽しみ、新しいアイデアを受け入れる人'
    },
    'INFJ': {
        name: '提唱者',
        emoji: '🌟',
        traits: '深い洞察力と理想主義を持ち、直感で人を理解する',
        communication: '誠実で思いやりのある言葉遣い。相手の気持ちを読み取る',
        needs: '価値観の共鳴。深い理解と共感を示してくれる知的な相手'
    },
    'INFP': {
        name: '仲介者',
        emoji: '🌈',
        traits: '理想主義的で共感力があり、創造性豊か',
        communication: '感情的で表現豊か。相手の個性を尊重し、深い話を好む',
        needs: '理解と自由。自分の価値観を尊重し、夢を共有してくれる人'
    },
    'ENFJ': {
        name: '主人公',
        emoji: '🤝',
        traits: 'カリスマ性があり、他者の成長を支援することに喜びを感じる',
        communication: '温かく励ましの言葉をかける。調和を重視し、共感的',
        needs: '感情的なつながり。自分の献身を理解し、成長を共にできる人'
    },
    'ENFP': {
        name: '運動家',
        emoji: '✨',
        traits: '熱意があり、創造性があり、自由を愛する',
        communication: '感情的で表現豊か。ポジティブなエネルギーを伝える',
        needs: '理解と自由。自分の価値観を尊重し、夢を共有してくれる人'
    },
    'ISTJ': {
        name: '管理者',
        emoji: '📊',
        traits: '責任感が強く、計画的・秩序的。規則や伝統を重んじる',
        communication: '論理的で丁寧。事実に基づいた話し方を好む',
        needs: '信頼性と誠実さ。計画に協力してくれる堅実な人'
    },
    'ISFJ': {
        name: '擁護者',
        emoji: '🛡️',
        traits: '優しく献身的で、他者を助けることを大切にする',
        communication: '穏やかで聞き上手。相手に共感しながら話す',
        needs: '感謝と共感。自分の努力を理解し認めてくれる優しい人'
    },
    'ESTJ': {
        name: '幹部',
        emoji: '🎯',
        traits: '組織的で実践的。リーダーシップを発揮し、効率を重視',
        communication: '直接的で明確。目標達成に向けた実践的な話を好む',
        needs: '協力と尊重。自分の決定を支持し、共に目標に向かえる人'
    },
    'ESFJ': {
        name: '領事官',
        emoji: '💝',
        traits: '社交的で思いやりがあり、調和を大切にする',
        communication: '温かく協力的。相手の感情に配慮し、調和を保つ',
        needs: '安定と感謝。自分の配慮を認め、感情的なつながりを大切にする人'
    },
    'ISTP': {
        name: '巨匠',
        emoji: '🔧',
        traits: '実践的で論理的。手を動かして問題を解決することを好む',
        communication: '簡潔で論理的。必要最小限の言葉で効率的に伝える',
        needs: '自由と理解。自分のペースを尊重し、実践的な活動を共有できる人'
    },
    'ISFP': {
        name: '冒険家',
        emoji: '🎨',
        traits: '穏やかで柔軟性があり、美的センスに優れる',
        communication: '控えめで優しい。行動で愛情を示すことが多い',
        needs: '尊重と自由。自分の価値観を理解し、創造性を認めてくれる人'
    },
    'ESTP': {
        name: '起業家',
        emoji: '🏃',
        traits: '行動的で現実的。スリルを求め、今を生きる',
        communication: '直接的でユーモアがある。実践的な話題を好む',
        needs: '刺激と柔軟性。冒険を共にし、自由を尊重してくれる人'
    },
    'ESFP': {
        name: 'エンターテイナー',
        emoji: '🎭',
        traits: '陽気で自発的。人生を楽しみ、周囲を明るくする',
        communication: '感情豊かで楽しい。現在の瞬間を大切にする',
        needs: '楽しさと受容。自分の明るさを受け入れ、人生を共に楽しめる人'
    }
};

// 相性データ（5段階評価）
const compatibilityData = {
    // ゴールデンペア（★★★★★）
    'INTJ-ENFP': {
        score: 5,
        title: '完璧な補完関係',
        description: 'INTJの論理性とENFPの感情豊かさが見事に補完し合います。お互いの違いが魅力となり、深い理解と成長を促す理想的な関係です。',
        goodPoints: [
            'INTJの戦略的思考がENFPのアイデアを実現可能な計画に変換',
            'ENFPの共感力がINTJの内向的感情を自然に引き出す',
            '互いの独立性を尊重しながら深いつながりを維持できる'
        ],
        cautionPoints: [
            'INTJの直接的な表現がENFPを傷つける可能性がある',
            'ENFPの感情重視の判断をINTJが理解しにくい場合がある',
            '社交性のレベルに大きな差があることを認識する'
        ],
        advice: {
            'INTJ→ENFP': [
                {
                    title: 'アイデアの実現可能性を探る',
                    description: '相手のアイデアに対し、「そのアイデア、面白いな。実現するための第一歩は何だろう？」と一緒に考える。'
                },
                {
                    title: '感情の共有に応じる',
                    description: '「君がそんなに喜んでいると、私まで嬉しい気分になるな」と、相手の感情に影響されていることを伝える。'
                },
                {
                    title: '自分の世界に招待する',
                    description: '自分の趣味や研究について、「少し専門的だけど、私の世界を少し覗いてみないか？」と、心を開く。'
                }
            ],
            'ENFP→INTJ': [
                {
                    title: '相手の計画を面白がる',
                    description: '「その計画、すごい！まるで映画みたいだね！ワクワクする！」と、相手のビジョンを称賛する。'
                },
                {
                    title: '相手の世界に飛び込む',
                    description: '相手の趣味や研究について、「私にも教えて！面白そう！」と、純粋な好奇心を示す。'
                },
                {
                    title: '感情を伝える',
                    description: '「あなたがそう言ってくれると、心がポカポカするんだ」と、自分の感情の変化を素直に伝える。'
                }
            ]
        }
    },
    'ENFP-INTJ': {
        score: 5,
        title: '完璧な補完関係',
        description: 'ENFPの温かさがINTJの内向性を引き出し、INTJの深い洞察力がENFPの創造性を刺激します。',
        goodPoints: [
            'ENFPの人間関係スキルがINTJの世界を広げる',
            'INTJの長期ビジョンがENFPの才能に方向性を与える',
            '互いの価値観を尊重しながら新しい視点を獲得できる'
        ],
        cautionPoints: [
            'ENFPの即興性とINTJの計画性の調整が必要',
            'INTJの批判的思考がENFPの自信を削ぐ可能性',
            '感情処理の方法と速度に大きな差がある'
        ],
        advice: {
            'ENFP→INTJ': [
                {
                    title: '相手の計画を面白がる',
                    description: '「その計画、すごい！まるで映画みたいだね！ワクワクする！」と、相手のビジョンを称賛する。'
                },
                {
                    title: '相手の世界に飛び込む',
                    description: '相手の趣味や研究について、「私にも教えて！面白そう！」と、純粋な好奇心を示す。'
                },
                {
                    title: '感情を伝える',
                    description: '「あなたがそう言ってくれると、心がポカポカするんだ」と、自分の感情の変化を素直に伝える。'
                }
            ],
            'INTJ→ENFP': [
                {
                    title: 'アイデアの実現可能性を探る',
                    description: '相手のアイデアに対し、「そのアイデア、面白いな。実現するための第一歩は何だろう？」と一緒に考える。'
                },
                {
                    title: '感情の共有に応じる',
                    description: '「君がそんなに喜んでいると、私まで嬉しい気分になるな」と、相手の感情に影響されていることを伝える。'
                },
                {
                    title: '自分の世界に招待する',
                    description: '自分の趣味や研究について、「少し専門的だけど、私の世界を少し覗いてみないか？」と、心を開く。'
                }
            ]
        }
    },
    'INTP-ENTJ': {
        score: 5,
        title: '知的パートナーシップ',
        description: '論理的思考を共有し、互いの知性を刺激し合う最高の組み合わせ。革新的なアイデアを実現できます。',
        goodPoints: [
            'INTPの創造的分析力がENTJの戦略に深みを与える',
            'ENTJのリーダーシップがINTPのアイデアを現実化',
            '互いの知的レベルを最大限に引き出し合える'
        ],
        cautionPoints: [
            'ENTJの性急さがINTPの熟考時間を奪う危険性',
            '論理だけに偏り感情面のケアが不足しがち',
            'INTPの優柔不断さがENTJをイライラさせる可能性'
        ],
        advice: {
            'INTP→ENTJ': [
                {
                    title: '最高の参謀になる',
                    description: '相手の壮大な計画に対し、「その計画には〇〇というリスクがある。代替案として3つ提示しよう」と、戦略的パートナーになる。'
                },
                {
                    title: '相手の決断を信頼する',
                    description: '「論理的に考えて、君の判断が最も合理的だ。これに従う」と、全幅の信頼を置く。'
                },
                {
                    title: '能力を称賛する',
                    description: '「君のその実行力と私の分析力が組めば、不可能はないな」と、最強のチームであることを確認する。'
                }
            ],
            'ENTJ→INTP': [
                {
                    title: '最高の参謀として扱う',
                    description: '「我が帝国の最高の頭脳よ、この問題に対する最善の策を提示せよ」と、最大の敬意を払って意見を求める。'
                },
                {
                    title: '研究環境を提供する',
                    description: '「君が研究に没頭できるよう、最高の環境を用意した。あとは、世界を驚かす発見を待つだけだ」と、サポートを約束する。'
                },
                {
                    title: '能力を称賛する',
                    description: '「君のその知性、100万の軍勢に匹敵する」と、その価値を称える。'
                }
            ]
        }
    },
    'ENTJ-INTP': {
        score: 5,
        title: '知的パートナーシップ',
        description: 'ENTJのリーダーシップとINTPの分析力が絶妙にマッチ。大きな目標を達成できるパワーカップルです。',
        goodPoints: [
            'ENTJの実行力がINTPの理論を具体的成果に変換',
            'INTPの客観的視点がENTJの判断ミスを防ぐ',
            '互いの専門領域を深く理解し尊重できる'
        ],
        cautionPoints: [
            'ENTJの結論急ぎがINTPの分析プロセスを阻害',
            '成果重視で感情的なつながりが希薄になりがち',
            'INTPの理論偏重をENTJが非現実的と感じる'
        ],
        advice: '重要な決断では相手に「1週間考える時間」を必ず与えましょう。「今すぐ」ではなく「いつまでに」で期限を伝えましょう。週末は必ず仕事の話を禁止にして二人の時間を作りましょう。相手の分析力を「君の分析のおかげで失敗を避けられた」と具体的に感謝しましょう。性急に結論を求めず、相手の思考プロセスを尊重しましょう。'
    },

    // 高相性（★★★★☆）
    'INFJ-ENFJ': {
        score: 4,
        title: '深い共感関係',
        description: '共に理想主義的で、深い感情的なつながりを築けます。お互いの価値観を理解し、支え合える関係です。',
        goodPoints: [
            'INFJの内省的洞察とENFJの表現力が完璧に調和',
            '相手の感情を言葉にする前に察知し合える',
            '共通の価値観で社会貢献や人助けに取り組める'
        ],
        cautionPoints: [
            '理想主義が強すぎて現実的な問題を先送りしがち',
            'お互いを気遣いすぎて本音を言えない状況',
            '他者優先で自分たちの関係をおろそかにする'
        ],
        advice: '月1回は「不満や改善点を正直に話す時間」を設けましょう。お金や家事などの現実的な話し合いを週1回必ず行いましょう。他人を助ける前に「まず自分たちの関係は大丈夫？」と確認しましょう。自分の考えを声に出して相手に伝え、内にこもりがちな感情も表現しましょう。デートの時は他人の話は禁止にして二人だけの時間を大切にしましょう。'
    },
    'ENFJ-INFJ': {
        score: 4,
        title: '深い共感関係',
        description: 'ENFJの社交性とINFJの洞察力が調和し、深い理解に基づいた温かい関係を築けます。',
        goodPoints: [
            '相手の感情を敏感に察知',
            '成長を支え合える',
            '調和的な関係を維持しやすい'
        ],
        cautionPoints: [
            '他者優先で自分を犠牲にしがち',
            'ストレスを内に溜め込む傾向',
            '境界線の設定が必要'
        ],
        advice: 'お互いの感情だけでなく、自分自身のケアも忘れずに。正直なコミュニケーションを心がけましょう。'
    },
    'ISFJ-ESFJ': {
        score: 4,
        title: '安定した支え合い',
        description: '共に思いやりがあり、安定を重視。伝統的な価値観を共有し、温かい家庭を築けます。',
        goodPoints: [
            '家族や伝統を大切にする',
            '実践的なサポートが得意',
            '調和的で平和な関係'
        ],
        cautionPoints: [
            '変化や冒険が少なくなりがち',
            '外部からの批判に敏感',
            'ルーティンに縛られすぎる可能性'
        ],
        advice: '安定を保ちながらも、時には新しい経験にチャレンジしてみましょう。'
    },
    'ESFJ-ISFJ': {
        score: 4,
        title: '安定した支え合い',
        description: 'ESFJの社交性とISFJの献身性が良いバランス。お互いを大切にし、長続きする関係を築けます。',
        goodPoints: [
            '相手への配慮が自然',
            '実生活での協力がスムーズ',
            '感謝の気持ちを表現し合える'
        ],
        cautionPoints: [
            '対立を避けすぎて問題を先送り',
            '他者の期待に応えようとしすぎる',
            '自己主張が弱くなりがち'
        ],
        advice: '時には自分の意見もはっきり伝え、健全な議論も大切にしましょう。'
    },
    'ISTP-ESTP': {
        score: 4,
        title: '実践的な冒険コンビ',
        description: '共に現実的で行動派。実践的な活動を通じて絆を深め、刺激的な関係を楽しめます。',
        goodPoints: [
            'アクティブな活動を共有',
            '実践的な問題解決が得意',
            '自由を尊重し合える'
        ],
        cautionPoints: [
            '感情的な深さが不足しがち',
            '長期計画が苦手',
            'コミュニケーション不足に注意'
        ],
        advice: '行動だけでなく、感情を共有する時間も作りましょう。将来の計画も時には話し合って。'
    },
    'ESTP-ISTP': {
        score: 4,
        title: '実践的な冒険コンビ',
        description: 'ESTPのエネルギーとISTPの技術力が融合。実践的で楽しい関係を築けます。',
        goodPoints: [
            '現実的な解決策を見つけやすい',
            'お互いの独立性を尊重',
            '共通の趣味を楽しめる'
        ],
        cautionPoints: [
            '感情表現が苦手',
            '深い話を避ける傾向',
            'ルーティンワークが苦手'
        ],
        advice: '活動を共にするだけでなく、時には静かに語り合う時間も大切にしましょう。'
    },

    // 中相性（★★★☆☆）
    'INFP-ENFP': {
        score: 3,
        title: '理想を共有する仲間',
        description: '共に理想主義的で創造的。価値観は似ていますが、エネルギーレベルの違いに配慮が必要です。',
        goodPoints: [
            '創造性と理想を共有',
            '深い感情的理解',
            '自由を大切にする'
        ],
        cautionPoints: [
            '現実的な側面が弱い',
            '決断に時間がかかる',
            '感情的になりすぎることも'
        ],
        advice: '理想を追求しながらも、現実的な目標設定を心がけ、実践的なスキルも身につけましょう。'
    },
    'ENFP-INFP': {
        score: 3,
        title: '理想を共有する仲間',
        description: '感情的な深さを共有できますが、ENFPの社交性とINFPの内向性のバランスが課題です。',
        goodPoints: [
            '価値観の深い共鳴',
            '創造的なプロジェクトを楽しめる',
            '感情的なサポートが得意'
        ],
        cautionPoints: [
            '社交レベルの違い',
            '現実的な計画が苦手',
            '批判に敏感すぎる'
        ],
        advice: 'お互いのエネルギーレベルを理解し、一人の時間と一緒の時間のバランスを取りましょう。'
    },
    'INTJ-ENTJ': {
        score: 3,
        title: '戦略的同盟',
        description: '共に目標志向で論理的。競争心が強くなりすぎないよう注意が必要です。',
        goodPoints: [
            '高い目標を共有できる',
            '効率的な意思決定',
            '知的な刺激を与え合える'
        ],
        cautionPoints: [
            '主導権争いの可能性',
            '感情面の軽視',
            'ワーカホリックになりがち'
        ],
        advice: '競争ではなく協力を意識し、感情的な側面も大切にしましょう。'
    },
    'ENTJ-INTJ': {
        score: 3,
        title: '戦略的同盟',
        description: 'ビジョンを共有できる強力なペアですが、リーダーシップスタイルの違いに注意。',
        goodPoints: [
            '長期的な計画を立てやすい',
            '論理的な議論を楽しめる',
            '成功への意欲を共有'
        ],
        cautionPoints: [
            'コントロール欲の衝突',
            '柔軟性の欠如',
            '批判的になりすぎる'
        ],
        advice: '役割分担を明確にし、お互いの専門領域を尊重しましょう。'
    },
    'ISTJ-ESTJ': {
        score: 3,
        title: '秩序と効率の組み合わせ',
        description: '共に実践的で責任感が強い。安定した関係ですが、変化への対応が課題です。',
        goodPoints: [
            '責任感と信頼性',
            '計画的な生活',
            '伝統を大切にする'
        ],
        cautionPoints: [
            '柔軟性の欠如',
            '感情表現が少ない',
            '新しいことへの抵抗'
        ],
        advice: '時には計画を離れて spontaneous な時間を作り、感情も素直に表現しましょう。'
    },
    'ESTJ-ISTJ': {
        score: 3,
        title: '秩序と効率の組み合わせ',
        description: 'ESTJのリーダーシップとISTJの着実さが調和。ただし、硬直的になりすぎないよう注意。',
        goodPoints: [
            '目標達成への強い意志',
            '実践的な協力関係',
            '約束を守る信頼性'
        ],
        cautionPoints: [
            '創造性や革新性が不足',
            '規則に縛られすぎる',
            '感情的な親密さが少ない'
        ],
        advice: 'ルールや計画も大切ですが、時には自由な発想や感情的な交流も楽しみましょう。'
    },

    // 低相性（★★☆☆☆）
    'INTJ-ESFP': {
        score: 2,
        title: '対照的な世界観',
        description: '論理と感情、計画と自発性が対立しやすい。理解には努力が必要ですが、学びも多い関係です。',
        goodPoints: [
            'INTJがESFPから人生の楽しみ方を学べる',
            'ESFPがINTJから長期的視点と計画性を学べる',
            '正反対だからこそ新鮮な驚きが続く'
        ],
        cautionPoints: [
            'INTJの理論的説明がESFPには堅苦しく感じられる',
            'ESFPの感情表現の豊かさをINTJが理解しにくい',
            'ライフペースと価値観の根本的な違い'
        ],
        advice: '相手に説明する時は「例え話」を使って3分以内にまとめましょう。お互いの時間の使い方を尊重し、自分の一人時間と相手の友人時間を確保しましょう。月1回は相手の得意分野を体験しましょう（美術館や音楽イベントなど）。相手を変えようとせず「違いを楽しむ」姿勢を持ちましょう。理論的説明より感情に寄り添った表現を心がけましょう。'
    },
    'ESFP-INTJ': {
        score: 2,
        title: '対照的な世界観',
        description: 'ESFPの今を楽しむ姿勢とINTJの長期計画志向が衝突しやすい。忍耐と理解が必要です。',
        goodPoints: [
            'お互いの弱点を補える可能性',
            '予想外の発見がある',
            '成長の機会が多い'
        ],
        cautionPoints: [
            '基本的な価値観の相違',
            'ペースの違いによるストレス',
            '理解し合うのに時間がかかる'
        ],
        advice: 'お互いの世界を否定せず、少しずつ歩み寄る努力をしましょう。'
    },
    'INTP-ESFJ': {
        score: 2,
        title: '論理と感情の衝突',
        description: '思考方法が大きく異なり、理解し合うのが困難。しかし、努力次第で補完関係になれます。',
        goodPoints: [
            '異なる強みを持つ',
            '新しい考え方を学べる',
            'バランスの取れた決定が可能'
        ],
        cautionPoints: [
            'コミュニケーションスタイルの違い',
            '優先順位の不一致',
            'お互いを理解するのに時間がかかる'
        ],
        advice: '相手の思考プロセスを尊重し、判断を急がないことが大切です。'
    },
    'ESFJ-INTP': {
        score: 2,
        title: '論理と感情の衝突',
        description: 'ESFJの感情重視とINTPの論理重視が衝突。お互いの言語を学ぶ必要があります。',
        goodPoints: [
            '全く異なる視点を得られる',
            'お互いの成長につながる',
            '補完的な関係の可能性'
        ],
        cautionPoints: [
            '基本的なニーズの違い',
            '誤解が生じやすい',
            'フラストレーションを感じやすい'
        ],
        advice: '相手の価値観を理解しようと努め、共通の興味を見つけることから始めましょう。'
    },

    // 最低相性（★☆☆☆☆）
    'ISFP-ENTJ': {
        score: 1,
        title: '価値観の根本的相違',
        description: '個人の価値観と効率性の追求が衝突。理解し合うには相当な努力と成熟が必要です。',
        goodPoints: [
            '極端に異なる視点から学べる',
            '忍耐力が鍛えられる',
            '成功すれば強い絆になる'
        ],
        cautionPoints: [
            'コミュニケーションが成立しにくい',
            'ストレスが多い関係',
            '基本的なニーズが正反対'
        ],
        advice: 'まずは相手を変えようとせず、理解することから始めましょう。共通の趣味を見つけることも有効です。'
    },
    'ENTJ-ISFP': {
        score: 1,
        title: '価値観の根本的相違',
        description: 'ENTJの支配的態度がISFPの自由を脅かす。相互理解には忍耐と愛情が不可欠です。',
        goodPoints: [
            '大きな成長の可能性',
            '新しい世界観を知れる',
            '克服できれば深い理解に至る'
        ],
        cautionPoints: [
            'パワーバランスの問題',
            '感情的な傷つきやすさ',
            '価値観の衝突が頻繁'
        ],
        advice: 'お互いの境界線を尊重し、強制ではなく提案の形でコミュニケーションを取りましょう。'
    },
    'ISFJ-ENTP': {
        score: 1,
        title: '安定と変化の対立',
        description: '伝統と革新、安定と変化が衝突。お互いの世界観を受け入れるのが非常に困難です。',
        goodPoints: [
            '全く新しい視点を得られる',
            '固定観念を打破できる',
            '成長の機会は豊富'
        ],
        cautionPoints: [
            '基本的な生活リズムの違い',
            '安心感vs刺激の求め方',
            '理解に至るまでが長い'
        ],
        advice: '小さな共通点から始めて、徐々に理解を深めていきましょう。急がないことが大切です。'
    },
    'ENTP-ISFJ': {
        score: 1,
        title: '安定と変化の対立',
        description: 'ENTPの挑戦的態度がISFJの安全欲求と衝突。建設的な関係には大きな努力が必要です。',
        goodPoints: [
            '互いの限界を超える機会',
            '忍耐と理解が深まる',
            '成功すれば非常に強い関係'
        ],
        cautionPoints: [
            '日常的な摩擦が多い',
            'ストレスレベルが高い',
            '誤解と衝突が頻繁'
        ],
        advice: '相手に急激な変化を求めず「小さな冒険から始めよう」と段階的に提案しましょう。毎週金曜日は「今週の新発見」を共有し合う時間を作りましょう。自分の自由時間と相手の安心できるルーティン時間を両方確保しましょう。喧嘩になった時は「お互いの安全地帯を尊重する」を基本ルールにしましょう。相手のペースを尊重して急がせないよう心がけましょう。'
    },

    // 追加の高相性ペア
    'INFP-ENFJ': {
        score: 4,
        title: '理想を共有する導き手',
        description: 'INFPの純粋な理想とENFJの人を導く力が美しく調和。互いの価値観を深く理解し合える関係です。',
        goodPoints: [
            'ENFJがINFPの潜在能力を引き出す',
            'INFPがENFJの心の支えとなる',
            '共に理想の実現に向かって歩める'
        ],
        cautionPoints: [
            '理想が高すぎて現実的な問題を後回しにしがち',
            'INFPが自分を犠牲にしてENFJを支えすぎる',
            'お互いを気遣いすぎて本音を言えない'
        ],
        advice: 'INFPは「今日はこう思った」など小さな感情も素直に伝えましょう。ENFJは相手を導こうとする前に「どう思う？」と意見を聞きましょう。月1回は「お金や家事などの現実的な話し合い」を必ず行いましょう。INFPの創作活動やひとり時間をENFJが積極的に応援しましょう。ENFJが疲れた時はINFPが「今日は何もしなくていい日」を作ってあげましょう。'
    },

    'ENFJ-INFP': {
        score: 4,
        title: '理想を共有する導き手',
        description: 'ENFJの導く力がINFPの才能を開花させ、INFPの純粋さがENFJの心を癒します。',
        goodPoints: [
            'INFPの隠れた才能をENFJが見つけ出せる',
            'ENFJの使命感をINFPが心から理解する',
            '価値観レベルでの深いつながりを築ける'
        ],
        cautionPoints: [
            'ENFJが指導的になりすぎてINFPが萎縮する',
            'INFPの優柔不断さにENFJがイライラする',
            '他者への献身で自分たちの時間が不足する'
        ],
        advice: 'ENFJは答えを教える前に「君はどう感じた？」と相手の気持ちを聞きましょう。INFPは大切な決断の時は「今悩んでいることを教えて」と具体的に相談しましょう。週末は他人の話を一切禁止にして二人だけの時間を作りましょう。ENFJの理想実現をINFPが創造的にサポートしましょう。INFPが落ち込んだ時はENFJが「そのままの君が素晴らしい」と伝えましょう。'
    },

    'ISTP-ENFJ': {
        score: 2,
        title: '自由と導きの調整',
        description: 'ISTPの独立性とENFJの面倒見の良さが衝突しやすい。相互理解に時間と努力が必要です。',
        goodPoints: [
            'ISTPがENFJから感情表現を学べる',
            'ENFJがISTPから個人の境界線を学べる',
            '実践力と人間力のバランスが取れる'
        ],
        cautionPoints: [
            'ENFJの世話焼きをISTPが煩わしく感じる',
            'ISTPの無関心さにENFJが傷つく',
            'コミュニケーションの頻度と方法が合わない'
        ],
        advice: 'ENFJは「何か手伝うことある？」ではなく「必要な時は言ってね」と伝えましょう。ISTPは週1回は「今週ありがとう」と感謝を具体的に表現しましょう。ENFJの社交的な活動とISTPの一人時間を両方尊重しましょう。ISTPが疲れている時はENFJが無言で寄り添うだけにしましょう。お互いの趣味や興味に「教えて」という姿勢で関わりましょう。'
    },

    'ENFJ-ISTP': {
        score: 2,
        title: '自由と導きの調整',
        description: 'ENFJの人を導きたい気持ちとISTPの自由でいたい気持ちの調整が必要。',
        goodPoints: [
            'ENFJがISTPの技術力を社会に活かす手助けができる',
            'ISTPがENFJに冷静な判断力を提供できる',
            '感情と論理のバランスが取れた関係'
        ],
        cautionPoints: [
            'ENFJが一方的に世話を焼きがち',
            'ISTPが感情的な会話を避ける傾向',
            'ペースと価値観の大きな違い'
        ],
        advice: 'ENFJは相手に変化を求めず「今のままでも十分素晴らしい」と伝えましょう。ISTPは月1回は「最近の気持ち」を3分間だけでも話しましょう。ENFJの人助け活動をISTPが技術面でサポートする役割分担をしましょう。ISTPの実用的なアドバイスをENFJが素直に受け入れましょう。お互いの「必要な距離感」を話し合って決めましょう。'
    },

    'ESTP-INFJ': {
        score: 2,
        title: '行動と洞察の対比',
        description: 'ESTPs瞬発力とINFJの深い洞察力は正反対。理解し合えれば互いに成長できる関係です。',
        goodPoints: [
            'ESTpがINFJを現実世界に引き出す',
            'INFJがESTpに深い意味と方向性を与える',
            '即座の行動力と長期的視野の組み合わせ'
        ],
        cautionPoints: [
            'ESTpの衝動的な行動にINFJが疲れる',
            'INFJの慎重さをESTpが理解しにくい',
            'エネルギーレベルとペースの大きな違い'
        ],
        advice: 'ESTpは重要な決断の前に「5分だけ考える時間をもらえる？」とINFJに相談しましょう。INFJは相手の行動力を批判せず「今度は一緒に」と提案しましょう。ESTpの活動的な時間とINFJの静かな時間を毎日確保しましょう。INFJの直感を「なんとなく気になる」レベルでもESTpが聞いてあげましょう。月1回は「今月の反省と来月の計画」を一緒に話し合いましょう。'
    },

    'INFJ-ESTP': {
        score: 2,
        title: '行動と洞察の対比',
        description: 'INFJの深い思考とESTpの行動力は対極的。お互いの世界を理解する努力が必要です。',
        goodPoints: [
            'INFJの長期的ビジョンにESTpが行動力を提供',
            'ESTpの現実感覚がINFJの理想を実現に導く',
            '計画力と実行力の完璧な組み合わせの可能性'
        ],
        cautionPoints: [
            'INFJがESTpのペースについていけない',
            'ESTpがINFJの内省的な時間を理解しにくい',
            '感情処理の方法と速度が大きく異なる'
        ],
        advice: 'INFJは「今すぐは無理だけど○日後なら」と具体的な代案を出しましょう。ESTpは相手が考えている時は「急がないよ」と声をかけましょう。INFJの一人時間とESTpの社交時間を互いに尊重しましょう。ESTpの冒険に月1回はINFJも参加してみましょう。INFJの「なんとなく嫌な予感」をESTpが馬鹿にせずに聞いてあげましょう。'
    },

    // ST×NF系の追加組み合わせ
    'ISTJ-ENFP': {
        score: 2,
        title: '秩序と自由の対比',
        description: 'ISTJの計画性とENFPの自発性が対立。理解し合うには大きな歩み寄りが必要です。',
        goodPoints: [
            'ISTJがENFPに安定性と実現可能性を提供',
            'ENFPがISTJに新しい視点と柔軟性をもたらす',
            '責任感と創造性のバランスが取れる可能性'
        ],
        cautionPoints: [
            'ISTJの規則性をENFPが窮屈に感じる',
            'ENFPの変化をISTJが理解しにくい',
            'ペースと価値観の根本的な違い'
        ],
        advice: 'ISTJは週に1回は「今日は予定を決めない日」を作りましょう。ENFPは大切な約束は必ずカレンダーに記入して守りましょう。ISTJの安定した計画とENFPの自由な時間を毎日両方確保しましょう。ENFPの新しいアイデアにISTJが「面白いね、どうすれば実現できる？」と聞いてあげましょう。ISTJの丁寧な仕事ぶりをENFPが「いつもありがとう」と具体的に褒めましょう。'
    },

    'ENFP-ISTJ': {
        score: 2,
        title: '自由と秩序の調和',
        description: 'ENFPの創造性とISTJの実行力は対照的。互いの強みを活かすには時間が必要です。',
        goodPoints: [
            'ENFPのアイデアをISTJが現実的に実行できる',
            'ISTJの信頼性がENFPに安心感を与える',
            '夢と現実のバランスの取れた関係'
        ],
        cautionPoints: [
            'ENFPがISTJのペースを遅く感じる',
            'ISTJがENFPの変化についていけない',
            'コミュニケーションスタイルの大きな違い'
        ],
        advice: 'ENFPは新しい提案をする時は「なぜそれがいいのか」理由も一緒に説明しましょう。ISTJは相手のアイデアを「無理」と言わず「時間をかけて考えよう」と応答しましょう。ENFPの社交時間とISTJのひとり時間を互いに尊重しましょう。月1回は「今月の目標達成度」を一緒に振り返りましょう。ENFPがISTJの几帳面さを「すごいね」と認めてあげましょう。'
    },

    'ESTP-INFP': {
        score: 2,
        title: '現実と理想の出会い',
        description: 'ESTPの現実主義とINFPの理想主義が衝突。理解には相当な努力が必要です。',
        goodPoints: [
            'ESTPがINFPを現実世界に引き出す',
            'INFPがESTPに深い価値観と意味を与える',
            '行動力と感受性の組み合わせの可能性'
        ],
        cautionPoints: [
            'ESTPの直接的な表現がINFPを傷つける',
            'INFPの感情重視をESTPが理解しにくい',
            'ライフスタイルと価値観の根本的な違い'
        ],
        advice: 'ESTPは相手を批判する前に「なぜそう思うの？」と理由を聞いてあげましょう。INFPは自分の気持ちを相手が理解できるよう具体例を使って説明しましょう。ESTPのアクティブな活動とINFPの静かな活動を週ごとに交代しましょう。INFPの価値観や理想をESTPが「大切なことだね」と認めてあげましょう。ESTPが疲れた時はINFPが何も言わずそばにいてあげましょう。'
    },

    'INFP-ESTP': {
        score: 2,
        title: '理想と現実の融合',
        description: 'INFPの内向的な感受性とESTPの外向的な行動力は対極的。相互理解が課題です。',
        goodPoints: [
            'INFPの深い感情をESTPが表現する手助けができる',
            'ESTPの実行力がINFPの理想を現実化する',
            '感情と行動のバランスが取れる関係の可能性'
        ],
        cautionPoints: [
            'INFPがESTPのペースについていけない',
            'ESTPがINFPの内省的な時間を理解しにくい',
            '感情処理の方法が正反対'
        ],
        advice: 'INFPは自分が疲れた時は「今日はひとりの時間が欲しい」と正直に伝えましょう。ESTPは相手の感情を「大げさ」と思わず「大切な気持ちだね」と受け止めましょう。INFPの創作活動をESTPが興味を持って見守りましょう。ESTPの冒険話をINFPが「楽しそう」と聞いてあげましょう。週1回は静かな場所で二人でゆっくり話す時間を作りましょう。'
    },

    // NP×SJ系の追加組み合わせ
    'ENTP-ISFJ': {
        score: 1,
        title: '革新と伝統の衝突',
        description: 'ENTPの変革志向とISFJの安定志向が対立。建設的な関係には忍耐が必要です。',
        goodPoints: [
            'ENTPがISFJに新しい視点をもたらす',
            'ISFJがENTPに安定性と継続性を教える',
            '革新と伝統のバランスが取れる可能性'
        ],
        cautionPoints: [
            'ENTPの変化がISFJを不安にさせる',
            'ISFJの慎重さをENTPが理解しにくい',
            '価値観と生活リズムの根本的な違い'
        ],
        advice: 'ENTPは新しい提案をする時は「失敗してもフォローする」と安心感を与えましょう。ISFJは「今はできないけど、将来的には考えてみる」と可能性を残しましょう。ENTPの自由な時間とISFJの安定したルーティンを両方確保しましょう。ISFJの心配事をENTPが「一緒に解決しよう」と寄り添いましょう。月1回は「お互いの譲れないもの」を確認し合いましょう。'
    },

    'ISFJ-ENTP': {
        score: 1,
        title: '安定と変革の調整',
        description: 'ISFJの守りたい気持ちとENTPの変えたい気持ちの調整が最大の課題です。',
        goodPoints: [
            'ISFJの安定感がENTPの冒険を支える基盤になる',
            'ENTPの創造性がISFJの世界を広げる',
            '継続性と革新性の組み合わせの可能性'
        ],
        cautionPoints: [
            'ISFJがENTPの変化に疲れてしまう',
            'ENTPがISFJの慎重さをもどかしく感じる',
            '日常的な摩擦が多くストレスが高い'
        ],
        advice: '「今すぐは無理だけど興味はある」と相手の提案を完全に拒否しないようにしましょう。「今日は何か新しいことを1つ試してみる」など、変化への小さな挑戦を心がけましょう。自分の「いつものやり方」と相手の「新しいやり方」を曜日で分けてみましょう。喧嘩した時は「お互いの良いところ」を3つずつ言い合うルールを作りましょう。相手の創造性を受け入れる努力をしましょう。'
    }
};

// 同じタイプ同士の相性を追加
const sameTypeCompatibility = {
    'INTJ-INTJ': {
        score: 3,
        title: '知的な理解者同士',
        description: '深い理解と知的な刺激を共有できますが、感情表現の不足に注意が必要です。',
        goodPoints: ['互いの独立性を完全に理解し尊重', '長期的なビジョンを共有しやすい', '効率的で無駄のない意思決定'],
        cautionPoints: ['感情的な親密さの表現が苦手で関係が冷たくなりがち', '批判的になりすぎて建設的でない議論になる', '社交的な活動を避けて世界が狭くなる'],
        advice: '毎日「今日の感謝」を1つずつ具体的に伝え合う。批判する時は「改善案」も一緒に提示する。月1回は外で他の人とも交流する機会を作る。お互いの専門分野で「先生」になって教え合う時間を作る。計画倒れを防ぐため、目標は小さく分けて達成感を共有する。'
    },
    'INTP-INTP': {
        score: 3,
        title: '理論家同士の探求',
        description: '知的な議論を心から楽しめますが、実践面や感情面での課題があります。',
        goodPoints: ['深い知的つながり', '自由の相互尊重', '創造的な議論'],
        cautionPoints: ['決断の先延ばし', '感情表現の困難', '日常管理の怠慢'],
        advice: 'INTP同士は理論的な話し合いを楽しみながらも、週1回は「今日の感謝」を具体的に伝え合いましょう。決断を先延ばしにしないよう「今週中に決めること」を紙に書いて共有しましょう。家事や実務は交代制にして「今日は君の番」と分担を明確にしましょう。お互いの興味分野を「教授」として教え合う時間を作りましょう。感情的な話が苦手でも月1回は「最近うれしかったこと」を話し合いましょう。'
    },
    'ENTJ-ENTJ': {
        score: 2,
        title: '指導者同士の同盟',
        description: '高い目標を共有できますが、主導権争いに陥りやすい関係です。',
        goodPoints: ['野心的な目標達成', '効率的な協力', '成功への意欲'],
        cautionPoints: ['支配欲の衝突', 'ワークライフバランス', '批判的すぎる態度'],
        advice: 'ENTJ同士は役割分担を明確にし「君は営業、僕は企画」など専門領域を決めましょう。毎週日曜日は仕事の話を禁止にして二人の時間を作りましょう。相手を批判する時は「改善案」もセットで提案しましょう。「今月の目標達成度」を互いに発表し合い、健全な競争を楽しみましょう。相手の成功を心から祝福し「君のおかげで成長できた」と感謝を伝えましょう。'
    },
    'ENTP-ENTP': {
        score: 3,
        title: '革新者同士の刺激',
        description: 'アイデアが飛び交う刺激的な関係ですが、実行力と継続性が課題です。',
        goodPoints: ['創造的な発想', '知的な刺激', '自由な議論'],
        cautionPoints: ['実行力の不足', '議論が長引く', '感情的配慮の欠如'],
        advice: 'ENTP同士はアイデアを出すだけでなく「今月必ず実行するもの」を3つ決めて実践しましょう。議論が白熱しすぎた時は「タイムアウト」を合言葉に休憩しましょう。お互いの感情を「今日はどんな気分？」と毎日確認し合いましょう。新しいプロジェクトを始める前に「今のものを完了させてから」を徹底しましょう。相手のアイデアに「それは面白い！具体的にはどうする？」と実現方法も一緒に考えましょう。'
    },
    'INFJ-INFJ': {
        score: 4,
        title: '深い魂の共鳴',
        description: '稀有な深い理解を共有できますが、現実逃避しやすい傾向があります。',
        goodPoints: ['直感的な理解', '価値観の共有', '精神的な深さ'],
        cautionPoints: ['理想主義の過剰', '現実面の弱さ', '感情の内向化'],
        advice: 'INFJ同士は深い理解を大切にしながらも、月1回は「家計や将来の具体的な計画」を必ず話し合いましょう。お互いが疲れた時は無理に話そうとせず「今日は静かに過ごそう」と休息を取りましょう。理想を語り合うのと同じ時間を現実的な問題解決にも使いましょう。相手の直感を「きっと当たってる」と信頼し合いましょう。感情が内にこもりがちなので「今の気持ちを一言で表すと？」と確認し合いましょう。'
    },
    'INFP-INFP': {
        score: 4,
        title: '理想主義者の共感',
        description: '深い感情的つながりを持てますが、実践面での弱さを補う必要があります。',
        goodPoints: ['価値観の深い共有', '創造性', '感情的理解'],
        cautionPoints: ['決断力の不足', '対立回避', '現実逃避'],
        advice: 'INFP同士は理想を共有しながらも「今週やらなければいけないこと」を紙に書いて目に見える場所に貼りましょう。決断を迫られた時は「心の声に従おう」と互いを励ましましょう。対立を避けがちなので「今ちょっと気になることがある」レベルでも正直に話しましょう。お互いの創作活動や趣味を積極的に応援し「すごく素敵だね」と褒め合いましょう。現実的な問題は「一緒に頑張ろう」と支え合って解決しましょう。'
    },
    'ENFJ-ENFJ': {
        score: 3,
        title: '献身者同士の調和',
        description: '他者への配慮は完璧ですが、自分たちのニーズを忘れがちです。',
        goodPoints: ['深い共感', '調和的関係', '成長への支援'],
        cautionPoints: ['自己犠牲の過剰', '境界線の曖昧さ', '理想の押し付け'],
        advice: 'ENFJ同士は他人を助ける前に「まず私たちの関係は大丈夫？」と確認し合いましょう。週1回は「今週自分のためにしたこと」を報告し合い、自己ケアを忘れないようにしましょう。相手のために疲れすぎている時は「今日は休んで」と言い合えるルールを作りましょう。理想を押し付けず「君はどう思う？」と相手の意見を聞く習慣をつけましょう。月1回は二人だけのデートで他人の話は一切禁止にしましょう。'
    },
    'ENFP-ENFP': {
        score: 3,
        title: '情熱的な冒険者たち',
        description: '楽しくエネルギッシュですが、安定性と継続性が課題となります。',
        goodPoints: ['互いのアイデアを無限に発展させられる', '感情を自由に表現し合える', '新しいことへの挑戦を応援し合える'],
        cautionPoints: ['現実的な計画や管理が苦手で生活が混乱しがち', '感情の浮き沈みが同期して極端になる', '集中力が続かず途中で投げ出すことが多い'],
        advice: '月末に「今月完了させること」を3つだけ決めて必ず実行する。家計簿や予定管理など「つまらないけど大切なこと」を交代制にする。感情が高ぶった時は「一度深呼吸してから話す」ルールを作る。新しいことを始める前に「今やってることを終わらせてから」を合言葉にする。定期的に現実的な友人に相談してアドバイスをもらう。'
    },
    'ISTJ-ISTJ': {
        score: 4,
        title: '信頼できる基盤',
        description: '安定した信頼関係を築けますが、変化や冒険が不足しがちです。',
        goodPoints: ['高い信頼性', '計画的な生活', '責任感の共有'],
        cautionPoints: ['柔軟性の欠如', '感情表現の少なさ', 'ルーティンへの固執'],
        advice: '安定を保ちながら、時には新しい経験にも挑戦してみましょう。'
    },
    'ISFJ-ISFJ': {
        score: 4,
        title: '優しさの循環',
        description: '思いやりに満ちた関係ですが、自己主張の弱さが問題になることも。',
        goodPoints: ['深い思いやり', '実践的サポート', '調和的な生活'],
        cautionPoints: ['対立回避', '変化への抵抗', '他者優先の過剰'],
        advice: '優しさを大切にしながら、時には自分の意見も主張しましょう。'
    },
    'ESTJ-ESTJ': {
        score: 2,
        title: '効率的な同盟',
        description: '目標達成には最適ですが、競争心と硬直性に注意が必要です。',
        goodPoints: ['高い生産性', '明確な役割分担', '目標の共有'],
        cautionPoints: ['支配欲の衝突', '感情の軽視', '柔軟性の不足'],
        advice: '効率だけでなく、感情的なつながりも意識的に育てましょう。'
    },
    'ESFJ-ESFJ': {
        score: 4,
        title: '調和の守護者',
        description: '温かく支え合える関係ですが、外部の意見に流されやすい面があります。',
        goodPoints: ['相互の配慮', '社交的な活動', '家族重視'],
        cautionPoints: ['他者の期待に敏感', '批判への弱さ', '自己主張の不足'],
        advice: '周囲との調和も大切ですが、二人の意見も大切にしましょう。'
    },
    'ISTP-ISTP': {
        score: 3,
        title: '独立した職人たち',
        description: '実践的で自由な関係ですが、感情的な親密さに課題があります。',
        goodPoints: ['独立性の尊重', '実践的協力', '問題解決能力'],
        cautionPoints: ['感情表現の困難', 'コミュニケーション不足', '長期計画の弱さ'],
        advice: '行動だけでなく、言葉でも気持ちを伝える努力をしましょう。'
    },
    'ISFP-ISFP': {
        score: 4,
        title: '穏やかな芸術家',
        description: '美的感覚を共有し穏やかな関係ですが、決断力に欠ける面があります。',
        goodPoints: ['価値観の共有', '創造的活動', '穏やかな雰囲気'],
        cautionPoints: ['対立回避', '決断の遅さ', '外部への閉鎖性'],
        advice: '美しいものを共有しながら、時には積極的な行動も必要です。'
    },
    'ESTP-ESTP': {
        score: 3,
        title: '行動派の冒険者',
        description: '刺激的で楽しい関係ですが、計画性と深い感情表現が課題です。',
        goodPoints: ['高い活動性', '現在を楽しむ', '実践的な解決'],
        cautionPoints: ['長期計画の不足', '感情の深さ不足', '衝動的行動'],
        advice: '今を楽しみながら、将来についても時々話し合いましょう。'
    },
    'ESFP-ESFP': {
        score: 3,
        title: '陽気な楽天家',
        description: '楽しく明るい関係ですが、責任感と継続性に注意が必要です。',
        goodPoints: ['高いエネルギー', '楽しい時間', '感情的オープンさ'],
        cautionPoints: ['計画性の欠如', '責任の回避', '深刻な話題の回避'],
        advice: '楽しさを保ちながら、責任も分かち合うことを学びましょう。'
    }
};

// すべての相性データを統合
Object.assign(compatibilityData, sameTypeCompatibility);

// 組み合わせに基づく具体的アドバイス生成関数
function generateSpecificAdvice(type1, type2, type1Data, type2Data) {
    // 基本的なアドバイステンプレート
    const baseAdvice = `${type1}は相手の${type2Data.needs}を理解し尊重しましょう。${type2}は相手の${type1Data.needs}をサポートしましょう。`;
    
    // タイプ組み合わせに基づく追加アドバイス
    let specificAdvice = '';
    
    // I vs E の組み合わせ
    if (type1.startsWith('I') && type2.startsWith('E')) {
        specificAdvice += `${type1}のひとり時間と${type2}の社交時間を互いに尊重しましょう。`;
    } else if (type1.startsWith('E') && type2.startsWith('I')) {
        specificAdvice += `${type1}の社交時間と${type2}のひとり時間を互いに尊重しましょう。`;
    }
    
    // S vs N の組み合わせ
    if ((type1.includes('S') && type2.includes('N')) || (type1.includes('N') && type2.includes('S'))) {
        specificAdvice += '現実的な視点と理想的な視点の両方を大切にしましょう。';
    }
    
    // T vs F の組み合わせ
    if ((type1.includes('T') && type2.includes('F')) || (type1.includes('F') && type2.includes('T'))) {
        specificAdvice += '論理的な判断と感情的な判断のバランスを取りましょう。';
    }
    
    // J vs P の組み合わせ
    if ((type1.includes('J') && type2.includes('P')) || (type1.includes('P') && type2.includes('J'))) {
        specificAdvice += '計画的な時間と自由な時間の両方を確保しましょう。';
    }
    
    // 共通アドバイス
    const commonAdvice = '週1回は「今週良かったこと・改善したいこと」を話し合う時間を作りましょう。価値観の違いが出た時は「なぜそう思うのか」の背景を聞き合いましょう。お互いの違いを「魅力的な個性」として受け入れましょう。';
    
    return baseAdvice + specificAdvice + commonAdvice;
}

// 相性データを双方向にする関数
function normalizeCompatibilityData() {
    const allTypes = Object.keys(mbtiTypes);
    
    // 既存のデータを双方向にする
    const keys = Object.keys(compatibilityData);
    keys.forEach(key => {
        const [type1, type2] = key.split('-');
        const reverseKey = `${type2}-${type1}`;
        
        // 逆方向のキーが存在しない場合は作成
        if (!compatibilityData[reverseKey] && type1 !== type2) {
            compatibilityData[reverseKey] = compatibilityData[key];
        }
    });
    
    // 不足している組み合わせにデフォルト値を設定
    allTypes.forEach(type1 => {
        allTypes.forEach(type2 => {
            const key = `${type1}-${type2}`;
            if (!compatibilityData[key]) {
                // タイプの特性を分析してより具体的なデフォルトデータを生成
                const type1Data = mbtiTypes[type1];
                const type2Data = mbtiTypes[type2];
                
                compatibilityData[key] = {
                    score: 3,
                    title: '成長し合える関係',
                    description: `${type1Data.name}(${type1})と${type2Data.name}(${type2})の組み合わせです。互いの特性を理解し尊重することで、バランスの取れた良い関係を築けます。`,
                    goodPoints: [
                        `${type1}の「${type1Data.traits.split('。')[0]}」な面を活かせる`,
                        `${type2}の「${type2Data.traits.split('。')[0]}」な面から学べる`,
                        '異なる視点から問題解決できる'
                    ],
                    cautionPoints: [
                        'コミュニケーションスタイルの違いを理解する',
                        `${type1}と${type2}のペースの違いに配慮が必要`,
                        '価値観の違いを話し合いで乗り越える'
                    ],
                    advice: generateSpecificAdvice(type1, type2, type1Data, type2Data)
                };
            }
        });
    });
}

// 擬人化データ
const characterizationData = {
    // ISTJ系パターン
    'ISTJ-ISTJ': '几帳面な図書館長 × 規律正しい教師',
    'ISTJ-ISFJ': '伝統を守る古物商 × 心優しき歴史保存家',
    'ISTJ-INFJ': '古代遺跡の番人 × 神秘を解き明かす預言者',
    'ISTJ-INTJ': '鉄壁の城の設計士 × 未来を見通す軍師',
    'ISTJ-ISTP': '精密機械の修理工 × 孤高のスナイパー',
    'ISTJ-ISFP': '古典音楽の指揮者 × 自由な魂を持つストリートダンサー',
    'ISTJ-INFP': '歴史書の編纂者 × 幻想世界の絵描き',
    'ISTJ-INTP': '古代文明の研究者 × 天才的な暗号解読家',
    'ISTJ-ESTP': '伝統武術の師範 × 命知らずの冒険家',
    'ISTJ-ESFP': '老舗旅館の跡継ぎ × 祭り好きの看板スター',
    'ISTJ-ENFP': '古書を守る図書館司書 × 未知を探る冒険家',
    'ISTJ-ENTP': '厳格な風紀委員長 × 校則破りの天才ハッカー',
    'ISTJ-ESTJ': '秩序を重んじる裁判官 × 鉄の意志を持つ社長',
    'ISTJ-ESFJ': '地域を守る消防団長 × みんなの世話役な町内会長',
    'ISTJ-ENFJ': '歴史博物館の館長 × 理想を語る教師',
    'ISTJ-ENTJ': '国家予算を管理する官僚 × 大企業を率いるCEO',

    // ISFJ系パターン
    'ISFJ-ISTJ': '献身的な執事 × 厳格な家庭教師',
    'ISFJ-ISFJ': '心優しき庭師 × 手作りお菓子が得意なパティシエ',
    'ISFJ-INFJ': '傷ついた動物を癒す獣医 × 人々の心を導くカウンセラー',
    'ISFJ-INTJ': '古代の秘術を守る神官 × 星の運行を読む占星術師',
    'ISFJ-ISTP': '患者に寄り添う看護師 × 精密な手術を行う医師',
    'ISFJ-ISFP': '温厚な絵本作家 × 自然を愛する写真家',
    'ISFJ-INFP': '孤児院の優しい先生 × 夢を紡ぐ童話作家',
    'ISFJ-INTP': '伝統工芸の職人 × 新素材を開発する研究者',
    'ISFJ-ESTP': '街の安全を守る警察官 × 危険を顧みないジャーナリスト',
    'ISFJ-ESFP': '地域のお祭りを支える世話役 × 笑顔を振りまくアイドル',
    'ISFJ-ENFP': '思い出の品を大切にする骨董品店主 × 新しい世界に飛び込む旅人',
    'ISFJ-ENTP': '神殿の守護者 × 禁断の知識を探る魔術師',
    'ISFJ-ESTJ': '伝統ある学校の校長先生 × 生徒を厳しく指導する教師',
    'ISFJ-ESFJ': '地域医療を支える町医者 × ボランティア活動に熱心な活動家',
    'ISFJ-ENFJ': '恵まれない人々を助ける慈善家 × 理想の社会を目指す活動家',
    'ISFJ-ENTJ': '王家に仕える忠実な侍従長 × 王国を改革する若き君主',

    // INTJ系パターン
    'INTJ-ENFP': '孤高の魔術師 × 自由な妖精',
    'INTJ-INFJ': '秘密結社の首領 × 神秘の力を持つ魔法使い',
    'INTJ-INTJ': '天才科学者 × 冷徹なスパイ',
    'INTJ-ESFP': '孤高の魔術師 × 魅惑の歌姫',

    // ENFP系パターン
    'ENFP-INTJ': '自由な妖精 × 孤高の魔術師',
    'ENFP-ISFJ': '新しい世界に飛び込む旅人 × 思い出の品を大切にする骨董品店主',
    'ENFP-ENFP': '夢を語り合う冒険家カップル',
    'ENFP-INFP': '自由を愛する旅芸人 × 星の王子様系アーティスト',

    // INTP系パターン
    'INTP-ENTJ': '夢見る錬金術師 × 鋼鉄の騎士',
    'INTP-ISFJ': '新素材を開発する研究者 × 伝統工芸の職人',
    'INTP-ESFP': '図書室の謎多き文学愛好家 × 学園の人気者',

    // INFJ系パターン
    'INFJ-ISTJ': '神秘を解き明かす預言者 × 古代遺跡の番人',
    'INFJ-ISFJ': '人々の心を導くカウンセラー × 傷ついた動物を癒す獣医',
    'INFJ-INFJ': '運命の糸を紡ぐ魔法使いカップル',
    'INFJ-INTJ': '神託を告げる預言者 × 星の運行を読む占星術師',
    'INFJ-ISTP': '神殿の神官 × 伝説の武器を作る職人',
    'INFJ-ISFP': '心の治療師 × 自然の声を聞くシャーマン',
    'INFJ-INFP': '夢の世界の案内人 × 幻想を描く画家',
    'INFJ-INTP': '古代文明の謎を解く考古学者 × 未知の理論を追う学者',
    'INFJ-ESTP': '禅寺の修行僧 × 命知らずのバウンティハンター',
    'INFJ-ESFP': '静かなる哲学者 × 舞台で輝く俳優',
    'INFJ-ENFP': '魂の導き手 × 希望の光を運ぶ天使',
    'INFJ-ENTP': '隠された真実を語る賢者 × 常識を覆す革命家',
    'INFJ-ESTJ': '精神世界の探求者 × 現実世界を統べる帝王',
    'INFJ-ESFJ': '心の癒し手 × 愛を分かち合う聖人',
    'INFJ-ENFJ': '人類の未来を憂う哲学者 × 理想の世界を築く教師',
    'INFJ-ENTJ': '神秘の知識を持つ大魔法使い × 鉄の意志で世界を変える皇帝',

    // ISTP系パターン
    'ISTP-ISTJ': '精密な時計職人 × 几帳面な経理担当',
    'ISTP-ISFJ': '黙々と作業する大工 × 家庭を支える家事の達人',
    'ISTP-INFJ': '伝説の武器を作る職人 × 神殿の巫女',
    'ISTP-INTJ': '天才的な発明家 × 冷徹な科学者',
    'ISTP-ISTP': '無口な職人カップル',
    'ISTP-ISFP': '寡黙な刀鍛冶 × 美しい陶芸家',
    'ISTP-INFP': '機械いじりが好きな修理工 × 詩を書く夢見る人',
    'ISTP-INTP': '実験室の技師 × 理論を追究する研究者',
    'ISTP-ESTP': '危険な任務をこなすスペシャリスト × 限界に挑むアスリート',
    'ISTP-ESFP': '静かな職人 × 明るい歌姫',
    'ISTP-ENFP': '一匹狼のガンマン × 自由を愛する旅人',
    'ISTP-ENTP': '謎多き発明家 × アイデアマンの発明家',
    'ISTP-ESTJ': '伝統技術の継承者 × 効率を追求するマネージャー',
    'ISTP-ESFJ': '温厚な町の修理屋 × 地域の世話役',
    'ISTP-ENFJ': '寡黙な職人 × 人を導く先生',
    'ISTP-ENTJ': '技術で世界を変えるエンジニア × 野心的な社長',

    // ISFP系パターン
    'ISFP-ISTJ': '自然を愛する写真家 × 規則正しい公務員',
    'ISFP-ISFJ': '優しい絵本作家 × 手作りお菓子の得意な人',
    'ISFP-INFJ': '自然の声を聞くシャーマン × 心の治療師',
    'ISFP-INTJ': '感性豊かな画家 × 戦略を練る軍師',
    'ISFP-ISTP': '美しい陶芸家 × 寡黙な刀鍛冶',
    'ISFP-ISFP': '平和を愛する芸術家カップル',
    'ISFP-INFP': '自由奔放な音楽家 × 夢見がちな詩人',
    'ISFP-INTP': '感性で世界を見る画家 × 論理で宇宙を探る研究者',
    'ISFP-ESTP': '穏やかな自然ガイド × エネルギッシュな冒険家',
    'ISFP-ESFP': '心優しい音楽家 × 陽気なダンサー',
    'ISFP-ENFP': '内気な詩人 × 自由な魂を持つ冒険家',
    'ISFP-ENTP': '静かな芸術家 × 革新的なアーティスト',
    'ISFP-ESTJ': '平和主義の画家 × 目標達成型のマネージャー',
    'ISFP-ESFJ': '優しい動物愛護家 × 慈愛に満ちた教師',
    'ISFP-ENFJ': '心の純粋な青年 × 人を導くカリスマ',
    'ISFP-ENTJ': '自由を愛する芸術家 × 鉄の意志を持つCEO',

    // ESTP系パターン
    'ESTP-ISTJ': '命知らずの冒険家 × 伝統を守る人',
    'ESTP-ISFJ': '危険を顧みないジャーナリスト × 街の安全を守る警察官',
    'ESTP-INFJ': '命知らずのバウンティハンター × 禅寺の修行僧',
    'ESTP-INTJ': '行動派の冒険家 × 戦略を練る参謀',
    'ESTP-ISTP': '限界に挑むアスリート × 危険な任務をこなすスペシャリスト',
    'ESTP-ISFP': 'エネルギッシュな冒険家 × 穏やかな自然ガイド',
    'ESTP-INFP': '現実主義の冒険家 × 夢見る詩人',
    'ESTP-INTP': '実践派の起業家 × 理論派の研究者',
    'ESTP-ESTP': 'スリルを求める冒険家カップル',
    'ESTP-ESFP': '度胸のあるレーサー × 華やかなアイドル',
    'ESTP-ENFP': 'ワイルドな冒険家 × 夢見る旅人',
    'ESTP-ENTP': '行動派の起業家 × アイデアマンの実業家',
    'ESTP-ESTJ': '現場のリーダー × 組織を動かすマネージャー',
    'ESTP-ESFJ': '活動的なスポーツ選手 × 応援上手なチアリーダー',
    'ESTP-ENFJ': '挑戦者の冒険家 × 人を導くコーチ',
    'ESTP-ENTJ': '現場を駆け回る営業エース × 戦略を立てる社長',

    // ESFP系パターン
    'ESFP-ISTJ': '祭り好きの看板スター × 老舗旅館の経営者',
    'ESFP-ISFJ': '笑顔を振りまくアイドル × 地域のお祭りを支える世話役',
    'ESFP-INFJ': '舞台で輝く俳優 × 静かなる哲学者',
    'ESFP-INTJ': '魅惑の歌手 × 孤高の魔術師',
    'ESFP-ISTP': '明るい歌手 × 静かな職人',
    'ESFP-ISFP': '陽気なダンサー × 心優しい音楽家',
    'ESFP-INFP': 'エンターテイナー × 夢見るアーティスト',
    'ESFP-INTP': '学園の人気者 × 図書室の謎多き文学愛好家',
    'ESFP-ESTP': '華やかなアイドル × 度胸のあるレーサー',
    'ESFP-ESFP': '太陽のように明るいカップル',
    'ESFP-ENFP': '今を楽しむエンターテイナー × 冒険を愛する旅人',
    'ESFP-ENTP': '人気者のタレント × 天才的なプロデューサー',
    'ESFP-ESTJ': '自由奔放なパフォーマー × 規律正しいマネージャー',
    'ESFP-ESFJ': '陽気なコメディアン × 愛情深いプロデューサー',
    'ESFP-ENFJ': '天真爛漫なタレント × カリスマ性のあるディレクター',
    'ESFP-ENTJ': '自由な魂のアーティスト × 野心的なプロデューサー',

    // ENTJ系その他の追加パターン
    'ENTJ-ISTJ': '大企業を率いるCEO × 国家予算を管理する官僚',
    'ENTJ-ISFJ': '王国を改革する若き君主 × 王家に仕える忠実な侍従長',
    'ENTJ-INFJ': '鉄の意志で世界を変える皇帝 × 神秘の知識を持つ大魔法使い',
    'ENTJ-INTJ': '野心的な社長 × 戦略を練る参謀',
    'ENTJ-ISTP': '戦略を立てる社長 × 現場を駆け回る営業エース',
    'ENTJ-ISFP': '鉄の意志を持つCEO × 自由を愛する芸術家',

    // ENTP系パターン
    'ENTP-ISTJ': '校則破りの天才ハッカー × 厳格な風紀委員長',
    'ENTP-ISFJ': '禁断の知識を探る魔術師 × 神殿の守護者',
    'ENTP-INFJ': '常識を覆す革命家 × 隠された真実を語る賢者',
    'ENTP-INTJ': '破天荒な発明家 × 冷静沈着な戦略家',
    'ENTP-ISTP': 'アイデアマンの発明家 × 謎多き発明家',
    'ENTP-ISFP': '革新的なアーティスト × 静かな芸術家',
    'ENTP-INFP': '奇想天外な発想家 × 夢見る詩人',
    'ENTP-INTP': '理論を覆す革命家 × 既存の理論を追求する学者',
    'ENTP-ESTP': 'アイデアマンの実業家 × 行動派の起業家',
    'ENTP-ESFP': '天才的なプロデューサー × 人気者のタレント',
    'ENTP-ENFP': '革新的な思想家 × 自由な発想家',
    'ENTP-ENTP': '変革を起こす革命家カップル',
    'ENTP-ESTJ': '既存の常識を破る改革者 × 秩序を守る管理者',
    'ENTP-ESFJ': '新しいアイデアを生む発明家 × 伝統を大切にする世話役',
    'ENTP-ENFJ': '世界を変える思想家 × 人々を導く指導者',
    'ENTP-ENTJ': '創造的な破壊者 × 建設的な支配者',

    // ENFJ系パターン
    'ENFJ-ISTJ': '理想を語る教師 × 歴史博物館の館長',
    'ENFJ-ISFJ': '理想の社会を目指す活動家 × 恵まれない人々を助ける慈善家',
    'ENFJ-INFJ': '理想の世界を築く教師 × 人類の未来を憂う哲学者',
    'ENFJ-INTJ': '人々を導く指導者 × 完璧な計画を立てる戦略家',
    'ENFJ-ISTP': '人を導く先生 × 寡黙な職人',
    'ENFJ-ISFP': '人を導くカリスマ × 心の純粋な青年',
    'ENFJ-INFP': '理想を語る教師 × 夢を追いかける詩人',
    'ENFJ-INTP': '人を育てる指導者 × 知識を追求する研究者',
    'ENFJ-ESTP': '人を導くコーチ × 挑戦者の冒険家',
    'ENFJ-ESFP': 'カリスマ性のあるディレクター × 天真爛漫なタレント',
    'ENFJ-ENFP': '人々を導く教師 × 希望を運ぶメッセンジャー',
    'ENFJ-ENTP': '人々を導く指導者 × 世界を変える思想家',
    'ENFJ-ESTJ': '理想を掲げるリーダー × 現実を見据える管理者',
    'ENFJ-ESFJ': '社会を良くする活動家 × 人々を支える世話役',
    'ENFJ-ENFJ': '理想を共有する指導者カップル',
    'ENFJ-ENTJ': '人々を導く精神的指導者 × 組織を率いる実力者',

    // ESFJ系パターン
    'ESFJ-ISTJ': 'みんなの世話役な町内会長 × 地域を守る消防団長',
    'ESFJ-ISFJ': 'ボランティア活動に熱心な活動家 × 地域医療を支える町医者',
    'ESFJ-INFJ': '愛を分かち合う聖人 × 心の癒し手',
    'ESFJ-INTJ': '人々の世話をする管理者 × 完璧主義の戦略家',
    'ESFJ-ISTP': '地域の世話役 × 温厚な町の修理屋',
    'ESFJ-ISFP': '慈愛に満ちた教師 × 優しい動物愛護家',
    'ESFJ-INFP': '愛情深い世話役 × 純粋な心を持つ詩人',
    'ESFJ-INTP': '人々を支える世話役 × 論理を追求する研究者',
    'ESFJ-ESTP': '応援上手なチアリーダー × 活動的なスポーツ選手',
    'ESFJ-ESFP': '愛情深いプロデューサー × 陽気なコメディアン',
    'ESFJ-ENFP': '人々を支える世話役 × 夢と希望を運ぶ旅人',
    'ESFJ-ENTP': '伝統を大切にする世話役 × 新しいアイデアを生む発明家',
    'ESFJ-ESTJ': '協調性のある支援者 × 目標達成型のリーダー',
    'ESFJ-ESFJ': '思いやりに満ちた世話役カップル',
    'ESFJ-ENFJ': '人々を支える世話役 × 社会を良くする活動家',
    'ESFJ-ENTJ': '人々の幸せを願う世話役 × 組織を率いる強力なリーダー',

    // ESTJ系パターン
    'ESTJ-ISTJ': '鉄の意志を持つ社長 × 秩序を重んじる裁判官',
    'ESTJ-ISFJ': '生徒を厳しく指導する教師 × 伝統ある学校の校長先生',
    'ESTJ-INFJ': '現実世界を統べる帝王 × 精神世界の探求者',
    'ESTJ-INTJ': '組織を統率するリーダー × 長期戦略を立てる参謀',
    'ESTJ-ISTP': '効率を追求するマネージャー × 伝統技術の継承者',
    'ESTJ-ISFP': '目標達成型のマネージャー × 平和主義の画家',
    'ESTJ-INFP': '現実主義のリーダー × 理想主義の詩人',
    'ESTJ-INTP': '実行力のある管理者 × 理論を追求する研究者',
    'ESTJ-ESTP': '組織を動かすマネージャー × 現場のリーダー',
    'ESTJ-ESFP': '規律正しいマネージャー × 自由奔放なパフォーマー',
    'ESTJ-ENFP': '現実的な管理者 × 夢見る冒険家',
    'ESTJ-ENTP': '秩序を守る管理者 × 既存の常識を破る改革者',
    'ESTJ-ESTJ': '組織を牽引するリーダーカップル',
    'ESTJ-ESFJ': '目標達成型のリーダー × 協調性のある支援者',
    'ESTJ-ENFJ': '現実を見据える管理者 × 理想を掲げるリーダー',
    'ESTJ-ENTJ': '組織運営の専門家 × 企業帝国の皇帝'
};

// データの正規化を実行
normalizeCompatibilityData();